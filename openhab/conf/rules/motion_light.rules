var Timer delay=null
var Timer delay2=null
var Timer delay3=null
var Timer delay4=null


//HWR
rule "DetectPresenceAndSwitchLight_HWR_EG"
	when
		Item motionSensorHWR_Presence changed
	then
		if(motionSensorHWR_Presence.state == ON && lightLevelSensorHWR_Dark.state == ON)
			{
			if(delay !== null)
				{
					delay.cancel
					delay = null
				}


			sendCommand(lightActorHWR_Switch, ON)
			}

		else if(motionSensorHWR_Presence.state == OFF)
		{
			delay = createTimer(now.plusSeconds(20)) [|
			sendCommand(lightActorHWR_Switch, OFF)
			]
		}
	end


//Trepenhaus Keller
rule "DetectPresenceAndSwitchLight_Treppenhaus_UG"
	when
		Item motionSensorStairsUG_Presence changed or
		Item motionSensorUG_Presence changed
	then
		if(motionSensorStairsUG_Presence.state == ON || motionSensorUG_Presence.state == ON)
			{
			if(delay2 !== null)
				{
					delay2.cancel
					delay2 = null
				}

			sendCommand(lightActorStairsUG_Switch, ON)
			}

		else if(motionSensorStairsUG_Presence.state == OFF && motionSensorUG_Presence.state == OFF)
		{
			delay2 = createTimer(now.plusSeconds(20)) [|
			sendCommand(lightActorStairsUG_Switch, OFF)
			]
		}
		end


//Outdoor
		rule "DetectPresenceAndSwitchLight_Outdoor"
			when
				Item motionSensorOutdoor_Presence changed
			then
				if(motionSensorOutdoor_Presence.state == ON && lightLevelSensorOutdoor_Dark.state == ON)
					{
					if(delay3 !== null)
						{
							delay3.cancel
							delay3 = null
						}


					sendCommand(lightActorOutdoor_Switch, ON)
					}

				else if(motionSensorOutdoor_Presence.state == OFF)
				{
					delay3 = createTimer(now.plusSeconds(20)) [|
					sendCommand(lightActorOutdoor_Switch, OFF)
					]
				}
			end


//Flur EG
		rule "DetectPresenceAndSwitchLight_Flur_EG"
			when
				Item motionSensorEntrance_Presence changed
			then
				if(motionSensorEntrance_Presence.state == ON && lightLevelSensorEntrance_Dark.state == ON)
					{
					if(delay4 !== null)
						{
							delay4.cancel
							delay4 = null
						}


					sendCommand(lightActorEntrance_Switch, ON)
					}

				else if(motionSensorEntrance_Presence.state == OFF)
				{
					delay4 = createTimer(now.plusSeconds(20)) [|
					sendCommand(lightActorEntrance_Switch, OFF)
					]
				}
			end
			